<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="/mongo-nodejs-driver/2.0/img/favicon.png">

    <title>Authenticating</title>

    <link rel="stylesheet" href="/mongo-nodejs-driver/2.0/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="/mongo-nodejs-driver/2.0/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="/mongo-nodejs-driver/2.0/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="/mongo-nodejs-driver/2.0/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="/mongo-nodejs-driver/2.0/lib/highlight/styles/idea.css" />
<link rel="stylesheet" href="/mongo-nodejs-driver/2.0/lib/bootstrap-toggle/bootstrap-toggle.min.css" type="text/css" />
<link rel="stylesheet" href="/mongo-nodejs-driver/2.0/css/java.css" type="text/css" />


  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="/mongo-nodejs-driver/2.0/../">
        <img src="/mongo-nodejs-driver/2.0/img/logo-mongodb-header.png", alt="MongoDB.org" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <a href="https://university.mongodb.com" data-toggle="tooltip" data-placement="bottom" title="Free Online Classes">MongoDB University</a>
  <a href="http://www.mongodb.org/downloads" data-toggle="tooltip" data-placement="bottom" title="Download MongoDB">Downloads</a>
  <a href="http://www.mongodb.org/get-involved" data-toggle="tooltip" data-placement="bottom" title="Get involved with MongoDB">Community</a>
  <a href="http://docs.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Documentation">Docs</a>
  <a href="http://blog.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Blog">Blog</a>
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search docs">
    <input type="hidden" name="site" value="/mongo-nodejs-driver/2.0">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="/mongo-nodejs-driver/2.0/../">MongoDB Node.js Driver</a>
          <a class="version pull-right" href="/mongo-nodejs-driver/2.0">2.0</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
      
      
      
        
      
    
    
  
  


        
      
    
    
  


        
      
    
      
      
        
      
    
      
      
    
      
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          

          

          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-nodejs-driver/2.0/whats-new/" class="">
      <i class='fa fa-cog'></i>
      <span>What&#39;s New</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-nodejs-driver/2.0/whats-new/upgrading/">
        <i class='fa fa-wrench'></i>
        Upgrading to 2.0
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-nodejs-driver/2.0/getting-started/" class="">
      <i class='fa fa-road'></i>
      <span>Getting Started</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-nodejs-driver/2.0/getting-started/installation-guide/">
        <i class='fa'></i>
        Installation Guide
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-nodejs-driver/2.0/getting-started/quick-tour/">
        <i class='fa'></i>
        Quick Tour
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            













  




<li class="toctree-l1  current">
  <a href="/mongo-nodejs-driver/2.0/reference/" class="">
      <i class='fa fa-book'></i>
      <span>Reference</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        













  




<li class="toctree-l2  current">
  <a href="/mongo-nodejs-driver/2.0/reference/connecting/" class="">
      <i class='fa'></i>
      <span>Connecting</span>
      
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-nodejs-driver/2.0/reference/connecting/connection-settings/">
        <i class='fa'></i>
        Connection Settings
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-nodejs-driver/2.0/reference/connecting/ssl/">
        <i class='fa'></i>
        SSL
    </a>
  </li>


        
        
        
        
        













  




    <li class="toctree-l3">
    <a href="/mongo-nodejs-driver/2.0/reference/connecting/authenticating/">
        <i class='fa'></i>
        Authenticating
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-nodejs-driver/2.0/reference/crud/">
        <i class='fa'></i>
        CRUD Operations
    </a>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-nodejs-driver/2.0/reference/gridfs/" class="">
      <i class='fa'></i>
      <span>GridFS</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-nodejs-driver/2.0/reference/gridfs/gridstore/">
        <i class='fa'></i>
        GridStore
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-nodejs-driver/2.0/reference/management/" class="">
      <i class='fa'></i>
      <span>Management</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-nodejs-driver/2.0/reference/management/logging/">
        <i class='fa'></i>
        Logging
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-nodejs-driver/2.0/reference/management/apm/">
        <i class='fa'></i>
        APM
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/mongo-nodejs-driver/2.0/api/">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/node-mongodb-native">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/mongo-nodejs-driver/2.0/issues-help/">
        <i class='fa fa-life-ring'></i>
        Issues &amp; Help
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://gitter.im/mongodb/node-mongodb-native?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge">
        <img src='https://badges.gitter.im/Join Chat.svg'/>
        
    </a>
  </li>


          
        </ul>
        
    </div>
  </div>
  
</aside>

<div class="option-popup closed hidden" id="optionsVersionsPopup">
<div class="option-header">
  <i class="fa fa-gear"></i>
  <span>OPTIONS</span>
  <i class="fa fa-angle-up pull-right"></i>
</div>
<div class="option-body">
  <ul>
      
      <li>
        <label>Version</label>
        <div class="btn-group btn-group-xs pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Select Version <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" id="optionsVersionsMenu">
          </ul>
        </div>
      </li>

   


    

  </ul>
</div>
</div>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/node-mongodb-native/blob/2.0/docs/reference/content/reference/connecting/authenticating.md" target="_blank" title="Edit reference/connecting/authenticating.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  <li><a href="/mongo-nodejs-driver/2.0/reference/">Reference</a> <i class="fa fa-angle-right"></i></li>
  <li><a href="/mongo-nodejs-driver/2.0/reference/connecting/">Connecting</a> <i class="fa fa-angle-right"></i></li>
  <li>Authenticating</li>
</ul>
</div>




<h1 id="authentication">Authentication</h1>

<p>The Node.js driver supports all MongoDB <a href="http://docs.mongodb.org/manual/core/authentication/">authentication mechanisms</a>, including those
only available in the MongoDB <a href="http://docs.mongodb.org/manual/administration/install-enterprise/">Enterprise Edition</a>.</p>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
<p>MongoDB 3.0 changed the default authentication mechanism from
<a href="http://docs.mongodb.org/manual/core/authentication/#mongodb-cr-authentication">MONGODB-CR</a> to
<a href="http://docs.mongodb.org/manual/core/authentication/#scram-sha-1-authentication">SCRAM-SHA-1</a>.</p>

</div>
</p>

<h2 id="scram-sha-1">SCRAM-SHA-1</h2>

<p>To explicitly connect to MongoDB using <a href="http://docs.mongodb .org/manual/core/authentication/#scram-sha-1-authentication">SCRAM-SHA-1</a>, we pass the following parameters to the driver over the connection URI.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient,
  f = require('util').format,
  assert = require('assert');

// Connection URL
var url = 'mongodb://dave:password@localhost:27017?authMechanism=SCRAM-SHA-1&amp;authSource=db';
// Use connect method to connect to the Server
MongoClient.connect(url, function(err, db) {
  assert.equal(null, err);
  console.log(&quot;Connected correctly to server&quot;);

  db.close();
});
</code></pre>

<p>The URI uses the authMechanism <code>SCRAM-SHA-1</code> with the user <code>dave</code> and password <code>password</code> against the database <code>db</code>.</p>

<h2 id="mongodb-cr">MONGODB-CR</h2>

<p>To explicitly create a credential of type <a href="http://docs.mongodb.org/manual/core/authentication/#mongodb-cr-authentication">MONGODB-CR</a>, we pass the following parameters to the driver over the connection URI.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient,
  f = require('util').format,
  assert = require('assert');

// Connection URL
var url = 'mongodb://dave:password@localhost:27017?authMechanism=MONGODB-CR&amp;authSource=db';
// Use connect method to connect to the Server
MongoClient.connect(url, function(err, db) {
  assert.equal(null, err);
  console.log(&quot;Connected correctly to server&quot;);

  db.close();
});
</code></pre>

<p>The URI uses the authMechanism <code>MONGODB-CR</code> with the user <code>dave</code> and password <code>password</code> against the database <code>db</code>.</p>

<p><div class="admonition important">
<h5 class="admonition-title">important</h5>
<p>If you specify the <code>MONGODB-CR</code> authMechanism the authentication might fail once you upgrade MongoDB to 3.0 or higher due to new users only being created using the <code>SCRAM-SHA-1</code> mechanism.</p>

</div>
</p>

<h2 id="x509">X509</h2>

<p>The <a href="http://docs.mongodb.org/manual/core/authentication/#x-509-certificate-authentication">x.509</a> mechanism authenticates a user
whose name is derived from the distinguished subject name of the X.509 certificate presented by the driver during SSL negotiation. This
authentication method requires the use of SSL connections with certificate validation and is available in MongoDB 2.6 and newer.</p>

<p>The example below shows how you connect using a X509 certificate using <code>MongoClient</code>. We assume that the <code>client.pem</code> file here is a valid X509 certificate and that the MongoDB server is correctly configured.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient,
  f = require('util').format,
  assert = require('assert');

// Read the cert and key
var cert = fs.readFileSync(__dirname + &quot;/ssl/x509/client.pem&quot;);
var key = fs.readFileSync(__dirname + &quot;/ssl/x509/client.pem&quot;);

// User name
var userName = encodeURIComponent(&quot;CN=client,OU=kerneluser,O=10Gen,L=New York City,ST=New York,C=US&quot;);

// Connect using X509 authentication
MongoClient.connect(f('mongodb://%s@server:27017/test?authMechanism=MONGODB-X509&amp;ssl=true', userName), {
  server: {
      sslKey:key
    , sslCert:cert
    , sslValidate:false
  }
}, function(err, db) {
  assert.equal(null, err);
  console.log(&quot;Connected correctly to server&quot;);

  db.close();
});
</code></pre>

<p>See the MongoDB server
<a href="http://docs.mongodb.org/manual/tutorial/configure-x509-client-authentication/#add-x-509-certificate-subject-as-a-user">x.509 tutorial</a> for
more information about determining the subject name from the certificate.</p>

<h2 id="against-the-specified-database">Against The Specified Database</h2>

<h2 id="kerberos-gssapi-sspi">Kerberos (GSSAPI/SSPI)</h2>

<p><a href="http://www.mongodb.com/products/mongodb-enterprise">MongoDB Enterprise</a> supports proxy authentication through a Kerberos service. The Node.js driver supports Kerberos on UNIX via the MIT Kerberos library and on Windows via the SSPI API.</p>

<p>Below is an example on how to connect to MongoDB using Kerberos for UNIX.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient,
  f = require('util').format,
  assert = require('assert');

// KDC Server
var server = &quot;kerberos.example.com&quot;;
var principal = &quot;drivers@KERBEROS.EXAMPLE.COM&quot;;
var urlEncodedPrincipal = encodeURIComponent(principal);

// Let's write the actual connection code
MongoClient.connect(format(&quot;mongodb://%s@%s/kerberos?authMechanism=GSSAPI&amp;gssapiServiceName=mongodb&quot;, urlEncodedPrincipal, server), function(err, db) {
  assert.equal(null, err);

  db.close();
  test.done();
});
</code></pre>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
<p>The method refers to the <code>GSSAPI</code> authentication mechanism instead of <code>Kerberos</code> because technically the driver is authenticating via the
<a href="https://tools.ietf.org/html/rfc4752">GSSAPI</a> SASL mechanism.</p>

</div>
</p>

<h2 id="ldap-plain">LDAP (PLAIN)</h2>

<p><a href="http://www.mongodb.com/products/mongodb-enterprise">MongoDB Enterprise</a> supports proxy authentication through a Lightweight Directory
Access Protocol (LDAP) service.</p>

<pre><code class="language-js">var MongoClient = require('mongodb').MongoClient,
  f = require('util').format,
  assert = require('assert');

// LDAP Server
var server = &quot;ldap.example.com&quot;;
var user = &quot;ldap-user&quot;;
var pass = &quot;ldap-password&quot;;

// Url
var url = format(&quot;mongodb://%s:%s@%s/test?authMechanism=PLAIN&amp;maxPoolSize=1&quot;, user, pass, server);

// Let's write the actual connection code
MongoClient.connect(url, function(err, db) {
  test.equal(null, err);    

  db.close();
  test.done();
});
</code></pre>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
<p>The method refers to the <code>plain</code> authentication mechanism instead of <code>LDAP</code> because technically the driver is authenticating via the <a href="https://www.ietf.org/rfc/rfc4616.txt">PLAIN</a> SASL mechanism.</p>

</div>
</p>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/mongo-nodejs-driver/2.0/reference/connecting/ssl/">
      <i class="fa fa-long-arrow-left"> </i> SSL
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/mongo-nodejs-driver/2.0/reference/crud/">
    CRUD Operations <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li><a href="#authentication">Authentication</a>
<ul>
<li><a href="#scram-sha-1">SCRAM-SHA-1</a></li>
<li><a href="#mongodb-cr">MONGODB-CR</a></li>
<li><a href="#x509">X509</a></li>
<li><a href="#against-the-specified-database">Against The Specified Database</a></li>
<li><a href="#kerberos-gssapi-sspi">Kerberos (GSSAPI/SSPI)</a></li>
<li><a href="#ldap-plain">LDAP (PLAIN)</a></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "/mongo-nodejs-driver/2.0",
   VERSION:     "2.0",
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="/mongo-nodejs-driver/2.0/js/jquery.js"></script>
<script type="text/javascript" src="/mongo-nodejs-driver/2.0/lib/bootstrap.js"></script>
<script type="text/javascript" src="/mongo-nodejs-driver/2.0/js/navbar.js"></script>
<script type="text/javascript" src="/mongo-nodejs-driver/2.0/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="/mongo-nodejs-driver/2.0/js/scripts.js"></script>
<script type="text/javascript" src="/mongo-nodejs-driver/2.0/lib/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script type="text/javascript" src="/mongo-nodejs-driver/2.0/js/java.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29229787-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>

